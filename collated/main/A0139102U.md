# A0139102U
###### \dailyplanner\commons\util\ArgumentFormatUtil.java
``` java
public class ArgumentFormatUtil {

	public static boolean isValidAddArgumentFormat(String trimmedArgs) {
		if (trimmedArgs.length() != 1 && trimmedArgs.charAt(1) == '/') {
			return false;
		}
		for (int k = 0; k < trimmedArgs.length(); k++) {
			if (trimmedArgs.charAt(k) == '/') {
				if (!(k + 1 == trimmedArgs.length())) {
					if (trimmedArgs.charAt(k + 1) == ' ') {
						return false;
					}
				} else {
					if (trimmedArgs.charAt(k) == '/')
						return false;
				}

			}
		}
		return true;
	}

	public static boolean isValidEditArgumentFormat(String args) {
		args = args.trim();
	    //If no index, return invalid
	    if(noIndexInArgs(args)) {
	        return false;
	    }
	    
	    //Return false if string is only a number
	    if (StringUtils.isNumeric(args)) {
	        return false;
	    }
	    
	    //Return false if no space before s/
	    if(args.contains("s/")) {
	        if (ifNoWhiteSpaceBeforeParameter(args, "s/")) {
	            return false;
	        }
	    }
	    
	  //Return false if no space before e/
	    if(args.contains("e/")) {
	        if (ifNoWhiteSpaceBeforeParameter(args, "e/")) {
                return false;
            }
        }
	  //Return false if no space before c/
	    if(args.contains("c/")) {
	        if (ifNoWhiteSpaceBeforeParameter(args, "c/")) {
                return false;
            }
        }    
	    return true;  
	}

    private static boolean ifNoWhiteSpaceBeforeParameter(String args, String parameter) {
        return args.charAt(args.indexOf(parameter)-1) != ' ';
    }

    private static boolean noIndexInArgs(String args) {
        return !Character.isDigit(args.charAt(0));
    }
}
```
###### \dailyplanner\history\HistoryManager.java
``` java
public class HistoryManager {

	private Stack<Instruction> recordCommand = new Stack<Instruction>();

	public Instruction getLastInstruction() {
		return recordCommand.pop();
	}

	public void stackAddInstruction(ReadOnlyTask toPush) {
		recordCommand.push(new Instruction("A", toPush));
	}
	
	public void stackDeleteInstruction(ReadOnlyTask toPush) {
		recordCommand.push(new Instruction("D", toPush));
	}
	
	public void stackEditInstruction(ReadOnlyTask originalTask, ReadOnlyTask editedTask) {
		recordCommand.push(new Instruction("EA", originalTask));
		recordCommand.push(new Instruction("ED", editedTask));
    }

	public void stackUnpinInstruction(ReadOnlyTask taskToUnpin) {
		recordCommand.push(new Instruction("UP", taskToUnpin));
	}

	public void stackPinInstruction(ReadOnlyTask taskToUnpin) {
		recordCommand.push(new Instruction("P", taskToUnpin));
	}
	
	public void stackUncompleteInstruction(ReadOnlyTask taskToUncomplete) {
        recordCommand.push(new Instruction("UC", taskToUncomplete));
    }

    public void stackCompleteInstruction(ReadOnlyTask taskToComplete) {
        recordCommand.push(new Instruction("C", taskToComplete)); 
    }
}
```
###### \dailyplanner\history\Instruction.java
``` java
public class Instruction {

	private String reverseCommand;
	private ReadOnlyTask task;

	public Instruction(String cmd, ReadOnlyTask task) {
		this.reverseCommand = cmd;
		this.task = task;
	}

	public String getReverse() {
		return reverseCommand;
	}

	public void setReverse(String cmd) {
		this.reverseCommand = cmd;
	}
	
	public ReadOnlyTask getTask() {
		return this.task;
	}
}
```
###### \dailyplanner\logic\commands\AddCommand.java
``` java
    public int getIndexOfClashingTask(Task toCheck) {

        if (!(DateUtil.hasStartandEndTime(toCheck))) {
            return -1;
        }
        Time toAddStartTiming = toCheck.getStart().getTime();
        Time toAddEndTiming = toCheck.getEnd().getTime();

        for (int i = 0; i < taskList.size(); i++) {
            ReadOnlyTask storedTask = taskList.get(i);
            if (DateUtil.hasStartandEndTime(storedTask)) {
                if (notSameTask(toCheck, storedTask)) {
                    if (isSameStartDate(toCheck, storedTask)) {
                        Time tasksEndTiming = storedTask.getEnd().getTime();
                        Time tasksStartTiming = storedTask.getStart().getTime();

                        if (isStartTimeClashing(toAddStartTiming, tasksEndTiming, tasksStartTiming)) {
                            return i;
                        }
                        if (isEndTimeClashing(toAddEndTiming, tasksEndTiming, tasksStartTiming)) {
                            return i;
                        }
                        if (timingSpansEntireTask(toAddStartTiming, toAddEndTiming, tasksEndTiming, tasksStartTiming)) {
                            return i;
                        }
                    }
                }

            }
        }
        return -1;
    }
    
    private boolean notSameTask(Task toCheck, ReadOnlyTask storedTask) {
        return !(toCheck == storedTask);
    }

    private boolean timingSpansEntireTask(Time toAddStartTiming, Time toAddEndTiming, Time tasksEndTiming,
            Time tasksStartTiming) {
        return ((toAddEndTiming.compareTo(tasksEndTiming) > 0) || (toAddEndTiming.compareTo(tasksEndTiming) == 0))
                && ((toAddStartTiming.compareTo(tasksStartTiming) < 0)
                        || (toAddStartTiming.compareTo(tasksStartTiming) == 0));
    }

    private boolean isEndTimeClashing(Time toAddEndTiming, Time tasksEndTiming, Time tasksStartTiming) {
        return (toAddEndTiming.compareTo(tasksStartTiming) > 0) && (toAddEndTiming.compareTo(tasksEndTiming) < 0);
    }

    private boolean isStartTimeClashing(Time toAddStartTiming, Time tasksEndTiming, Time tasksStartTiming) {
        return (toAddStartTiming.compareTo(tasksEndTiming) < 0) && (toAddStartTiming.compareTo(tasksStartTiming) > 0);
    }

    private boolean isSameStartDate(Task toCheck, ReadOnlyTask storedTask) {
        return toCheck.getStart().getDate().compareTo(storedTask.getStart().getDate()) == 0;
    }

}
```
###### \dailyplanner\logic\commands\ClearCommand.java
``` java
    @Override
    public CommandResult execute() {
        assert model != null;
        model.resetData(DailyPlanner.getEmptyAddressBook());
        model.resetPinBoard();
        model.setLastTaskAddedIndex(0);
        return new CommandResult(MESSAGE_SUCCESS);
    }
}
```
###### \dailyplanner\logic\commands\EditCommand.java
``` java
public class EditCommand extends Command {

    public static final String COMMAND_WORD = "edit";

    public static final String MESSAGE_USAGE = COMMAND_WORD
            + ": Edits the task identified by the index number shown in current list.\n"
            + "Format: edit [INDEX] (must be a positive integer)[TASKNAME] s/[STARTDATE] [STARTTIME] e/[ENDDATE] [ENDTIME]\n"
            + "Example: " + COMMAND_WORD + " 2 s/3pm";

    public static final String MESSAGE_DUPLICATE_PERSON = "This task already exists in the daily planner";
    public static final String MESSAGE_EDIT_PERSON_SUCCESS = "Edited Task: %1$s";

    public final int targetIndex;
    private final Optional<String> taskName;
    private final Optional<DateTime> start;
    private final Optional<DateTime> end;
    private final Optional<Set<String>> tags;
    private Optional<UniqueCategoryList> tagSet;

    public EditCommand(int targetIndex, String taskName, DateTime start, DateTime end, Set<String> tags)
            throws IllegalValueException {
        this.targetIndex = targetIndex;
        this.taskName = Optional.ofNullable(taskName);
        this.start = Optional.ofNullable(start);
        this.end = Optional.ofNullable(end);
        this.tags = Optional.ofNullable(tags);
        this.tagSet = Optional.empty();

        if (tags.size() != 0) {
            final Set<Category> tagSet = new HashSet<>();

            for (String tagName : tags) {
                tagSet.add(new Category(tagName));
            }
            this.tagSet = Optional.of(new UniqueCategoryList(tagSet));
        }
    }

    @Override
    public CommandResult execute() {

        UnmodifiableObservableList<ReadOnlyTask> lastShownList = model.getFilteredPersonList();

        if (lastShownList.size() < targetIndex) {
            indicateAttemptToExecuteIncorrectCommand();
            return new CommandResult(Messages.MESSAGE_INVALID_TASK_DISPLAYED_INDEX);
        }

        ReadOnlyTask taskToEdit = lastShownList.get(targetIndex - 1);

        String toAddName = taskToEdit.getName();
        if (taskName.isPresent()) {
            toAddName = taskName.get();
        }
        DateTime toAddStart = taskToEdit.getStart();
        if (start.isPresent()) {
            toAddStart = start.get();
        }
        DateTime toAddEnd = taskToEdit.getEnd();
        if (end.isPresent()) {
            toAddEnd = end.get();
        }
        UniqueCategoryList toAddTags = taskToEdit.getTags();
        if (tagSet.isPresent()) {
            toAddTags = tagSet.get();
        }

        Task toAdd = new Task(toAddName, toAddStart, toAddEnd, taskToEdit.isComplete(), taskToEdit.isPinned(),
                toAddTags);

        try {
            model.getHistory().stackEditInstruction(taskToEdit, toAdd);
            model.deletePerson(taskToEdit);
            model.addPerson(toAdd);
            model.updatePinBoard();
        } catch (PersonNotFoundException pnfe) {
            assert false : "The target task cannot be missing";
        } catch (UniqueTaskList.DuplicatePersonException e) {
            return new CommandResult(MESSAGE_DUPLICATE_PERSON);
        }
        return new CommandResult(String.format(MESSAGE_EDIT_PERSON_SUCCESS, taskToEdit));

    }

}
```
###### \dailyplanner\logic\commands\FindCommand.java
``` java
    @Override
    public CommandResult execute() {
        model.updateFilteredPersonList(keywords);
        return new CommandResult(getMessageForPersonListShownSummary(model.getFilteredPersonList().size()));
    }

}
```
###### \dailyplanner\logic\commands\UndoCommand.java
``` java
		taskToUndo = undoInstruction.getTask();

		if (undoInstruction.getReverse().equals("A")) {
			try {
				model.addPerson((Task) taskToUndo);
			} catch (IllegalValueException e) {
				e.printStackTrace();
			}
		}

		if (undoInstruction.getReverse().equals("D")) {
			try {
				model.deletePerson(taskToUndo);
			} catch (PersonNotFoundException e) {
				e.printStackTrace();
			}
		}

		if (undoInstruction.getReverse().equals("ED")) {
			try {
				model.deletePerson(taskToUndo);

			} catch (PersonNotFoundException e) {
				e.printStackTrace();
			}

			// Get next instruction from stack to generate and add the old task
			// back
			// The instruction is guaranteed to be an "EA" instruction
			undoInstruction = model.getHistory().getLastInstruction();
			taskToUndo = null;

			taskToUndo = undoInstruction.getTask();

			try {
				model.addPerson((Task) taskToUndo);
			} catch (DuplicatePersonException e) {
				e.printStackTrace();
			}
		}
```
###### \dailyplanner\logic\parser\Parser.java
``` java

	private Command prepareEdit(String arguments) {

		int index = 0;
		String taskName = null;
		String start = null, end = null;
		DateTime formattedStart = null, formattedEnd = null;
		Set<String> tags = new HashSet<String>();
		
		String trimmedArgs = arguments.trim();
		
		if(!(ArgumentFormatUtil.isValidEditArgumentFormat(arguments))){
			return new IncorrectCommand(String.format(MESSAGE_INVALID_COMMAND_FORMAT, EditCommand.MESSAGE_USAGE));
		}

		HashMap<String, String> mapArgs = parseEdit(trimmedArgs);

		// If arguments are in hashmap, pass them to addCommand, if not pass
		// them as empty string
		// Change date to "dd/mm/yy/", time to "hh:mm"

		nattyParser natty = new nattyParser();

		if (mapArgs.containsKey("index")) {
			index = Integer.parseInt(mapArgs.get("index"));
		}
		if (mapArgs.containsKey("taskName")) {
			taskName = mapArgs.get("taskName");
		}
		if (mapArgs.containsKey("start")) {
			String startString = mapArgs.get("start");
			// if field is empty, delete start
			if (startString.equals("")) {
				formattedStart = new DateTime(new Date(""), new Time(""));
			}
			// if start time is given
			else if (startString.contains("am") || startString.contains("pm")) {
				start = natty.parse(startString);
				Date startDate = new Date(start.split(" ")[0]);
				Time startTime = new Time(start.split(" ")[1]);
				formattedStart = new DateTime(startDate, startTime);
			} else {
				start = natty.parseDate(startString);
				Date startDate = new Date(start);
				formattedStart = new DateTime(startDate, new Time(""));
			}
		}
		if (mapArgs.containsKey("end")) {
			String endString = mapArgs.get("end");
			// if field is empty, delete end
			if (endString.equals("")) {
				formattedEnd = new DateTime(new Date(""), new Time(""));
			}
			// if end time is given
			else if (endString.contains("am") || endString.contains("pm")) {
				// if end date is given
				if (endString.length() >= 7 && !Character.isDigit(endString.charAt(0))) {
					end = natty.parse(endString);
					Date endDate = new Date(end.split(" ")[0]);
					Time endTime = new Time(end.split(" ")[1]);
					formattedEnd = new DateTime(endDate, endTime);
				} else {
					Date endDate;
					if (!mapArgs.containsKey("start")) {
						endDate = new Date(natty.parseDate("today"));
					} else {
						endDate = new Date(start.split(" ")[0]);
					}
					Time endTime = new Time(natty.parseTime(endString));
					formattedEnd = new DateTime(endDate, endTime);
				}
			} else {
				end = natty.parseDate(endString);
				Date endDate = new Date(end);
				formattedEnd = new DateTime(endDate, new Time(""));
			}
		}
		if (mapArgs.containsKey("tags")) {
			// if field is empty, delete tags
			if (mapArgs.get("tags").equals("")) {
				tags = new HashSet<String>();
			} else {
				String[] tagArray = mapArgs.get("tags").split(" ");
				tags = new HashSet<String>(Arrays.asList(tagArray));
			}
		}

		try {
			return new EditCommand(index, taskName, formattedStart, formattedEnd, tags);
		} catch (IllegalValueException ive) {
			return new IncorrectCommand(ive.getMessage());
		}
	}

	/**
	 * Parses arguments in the context of the add person command.
	 *
	 * @param args
	 *            full command args string
	 * @return the prepared command
	 */

```
###### \dailyplanner\ui\HelpWindow.java
``` java
    private void configure(){
           Scene scene = new Scene(mainPane);
           //Null passed as the parent stage to make it non-modal.
           dialogStage = createDialogStage(TITLE, null, scene);
           dialogStage.setMaximized(true); //TODO: set a more appropriate initial size
           setIcon(dialogStage, ICON);
           
           WebView browser = new WebView();
         
			/*BufferedReader textFile;
			try {
				textFile = new BufferedReader(new FileReader("/images/HelpDoc.html"));
				try {
					String contentLine = textFile.readLine();
					System.out.println(contentLine);
					
					while(!(contentLine == null)){
						browser.getEngine().loadContent(contentLine);
					}
				} catch (IOException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			} catch (FileNotFoundException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}  */      
           
          
           browser.getEngine().loadContent("<h1>Help</h1><p style=\"color:blue;\"><b>add </b></br></p><p>add [TASKNAME] s/[START] e/[END]</p><p><sub>Except <mark>TASKNAME</mark>, all the fields above are optional</sub></p><em>Examples: </em><p>add Math Assignment s/today </p><p>add Music Lesson s/12Nov 2pm e/5pm</p><p>add Sleepover s/today 9pm e/11/11/2016 9am </p><p>add CS1020 Revision </p><p style=\"color:blue;\"><br><b>delete </b></br></p><p>delete [INDEX]</p><em>Examples: </em><p>delete 1 </p><p style=\"color:blue;\"><br><b>edit </b></br></p><p>edit [TASKNAME] s/[START] e/[END]</p><p><sub>Except <mark>TASKNAME</mark>, all the fields above are optional</sub></p><em>Examples: </em><p>edit 1 Math Assignment</p><p>edit 5 Music Lesson s/6pm e/7pm</p><p>edit 9 Freshmen Camp s/18Dec 1pm e/17112016 9am </p><p>edit 11 CS1020 Revision s/tomorrow </p><p style=\"color:blue;\"><br><b>find </b></br></p><p>find [TASKNAME]</p><em>Examples: </em><p>find CS1020 </p><p style=\"color:blue;\"><br><b>complete </b></br></p><p>complete[INDEX]</p><em>Examples: </em><p>complete 5 </p><p style=\"color:blue;\"><br><b>show </b></br></p><p>show [DATE]/[COMPLETED]</p><em>Examples: </em><p>show complete </p><p>show all </p><p>show today </p><p style=\"color:blue;\"><br><b>undo </b></br></p><p>undo</p><em>Examples: </em><p>undo</p><p style=\"color:blue;\"><br><b>help </b></br></p><p>help</p><em>Examples: </em><p>help </p>" );
           FxViewUtil.applyAnchorBoundaryParameters(browser, 0.0, 0.0, 0.0, 0.0);
           mainPane.getChildren().add(browser);
       }

    public void show() {
        dialogStage.showAndWait();
    }
}
```
